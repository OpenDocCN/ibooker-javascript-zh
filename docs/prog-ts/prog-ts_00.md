# 前言

这本书适合各种程序员：专业的 JavaScript 工程师、C# 开发者、Java 爱好者、Python 爱好者、Ruby 爱好者、Haskell 粉丝。无论你使用哪种语言，只要有一定的编程经验并了解函数、变量、类和错误的基础知识，这本书都适合你。对 JavaScript 有一定经验，包括对文档对象模型（DOM）和网络的基本了解，会帮助你更好地理解内容——虽然我们不深入讨论这些概念，但它们是出色示例的源泉，如果你不熟悉它们，可能会对示例的理解产生困难。

无论你之前使用过什么编程语言，我们都有一个共同的经历：追踪异常、逐行分析代码，找出问题所在以及如何修复它。TypeScript 可以自动检查你的代码并指出可能忽略的错误，从而帮助防止这种经历。

如果你以前没有使用过静态类型语言，也没关系。我将教你有关类型以及如何有效使用它们，以减少程序崩溃、改善代码文档化，并使你的应用程序在更多用户、工程师和服务器之间扩展。我会尽量避免使用专业术语，并以直观、记忆深刻和实用的方式解释思想，沿途使用大量示例来帮助保持具体性。

TypeScript 的一个特点是：与许多其他静态类型语言不同，它极其实用。它创造全新的概念，让你能更简洁、更准确地表达，使你以一种有趣、现代和安全的方式编写应用程序。

# 本书的组织结构

本书有两个目标：深入理解 TypeScript 语言的工作原理（理论）并提供大量实用建议，帮助编写生产级 TypeScript 代码（实践）。

因为 TypeScript 是一种非常实用的语言，理论很快就转化为实践，所以本书的大部分内容都是理论与实践的结合。头几章几乎完全是理论，而最后几章则几乎完全是实践。

我将从编译器、类型检查器以及类型的基础知识开始讲起。然后，我会广泛介绍 TypeScript 中不同的类型和类型操作符，它们的用途以及如何使用它们。利用所学，我将涵盖一些高级主题，如 TypeScript 最复杂的类型系统特性、错误处理和异步编程。最后，我将讲述如何将 TypeScript 与你喜爱的框架（前端和后端）结合使用，将现有的 JavaScript 项目迁移到 TypeScript，并将你的 TypeScript 应用投入生产环境。

大多数章节末尾都有一组练习题。试着自己完成这些练习——这比单纯阅读能更深入理解我们所讲内容。章节练习的答案可以在网上找到，网址是 [*https://github.com/bcherny/programming-typescript-answers*](https://github.com/bcherny/programming-typescript-answers)。

# 风格

在整本书中，我尽量保持一致的代码风格。这种风格的某些方面非常个人化，例如：

+   只在必要时使用分号。

+   我用两个空格缩进。

+   在程序是一个快速片段或程序结构比细节更重要时，我使用诸如 `a`、`f` 或 _ 的短变量名。

然而，代码风格的某些方面是我认为你也应该遵循的。其中一些是：

+   你应该使用最新的 JavaScript 语法和特性（最新的 JavaScript 版本通常称为“esnext”）。这将使你的代码符合最新的标准，提高互操作性和可搜索性，并有助于减少新员工的上手时间。它还可以让你利用强大的现代 JavaScript 特性，如箭头函数、Promise 和生成器。

+   你应该大多数时候使用扩展运算符 (`...`) 使你的数据结构不可变。^(1)

+   你应该确保每个东西都有一个类型，在可能的情况下推断类型。要小心不要滥用显式类型；这将有助于保持代码清晰简洁，并通过展示不正确的类型而不是简单覆盖它们来提高安全性。

+   你应该保持你的代码可重用和通用。多态性（见 “多态性”）是你的好朋友。

当然，这些想法并非新鲜事物。但 TypeScript 在遵循这些想法时表现特别出色。TypeScript 的内置降级编译器、对只读类型的支持、强大的类型推断、深度支持多态性以及完全结构化类型系统都鼓励良好的编码风格，同时语言保持极高的表达能力和对底层 JavaScript 的真实支持。

在我们开始之前，还有几点需要注意。

JavaScript 并没有暴露指针和引用；相反，它有值类型和引用类型。值是不可变的，包括字符串、数字和布尔值，而引用指向通常是可变的数据结构，如数组、对象和函数。在本书中，当我使用“值”一词时，通常是宽泛地指代 JavaScript 值或引用。

最后，在与 JavaScript 互操作、不正确类型化的第三方库、遗留代码或者时间紧迫时，你可能会发现自己在实际中写了不那么理想的 TypeScript 代码。本书大部分内容展示了你*应该*如何编写 TypeScript，并论述了为什么你应该尽力避免妥协。但实际上，你和你的团队的代码正确性取决于你们自己。

## 本书中使用的约定

本书使用以下排版约定：

*Italic*

指示新术语、网址、电子邮件地址、文件名和文件扩展名。

`Constant width`

用于程序清单，以及段落中引用程序元素，如变量或函数名、数据类型、环境变量、语句和关键字。

*`Constant width italic`*

显示应由用户提供值或由上下文确定的值替换的文本。

###### 提示

此元素表示提示或建议。

###### 注意

此元素表示一般注意事项。

###### 警告

此元素表示警告或注意事项。

# 使用示例代码

可以下载补充材料（示例代码、练习等）：[*https://github.com/bcherny/programming-typescript-answers*](https://github.com/bcherny/programming-typescript-answers)

本书旨在帮助你完成工作。一般情况下，如果本书提供示例代码，你可以在你的程序和文档中使用它。除非你复制了代码的大部分内容，否则无需征求我们的许可。例如，编写一个使用本书多个代码片段的程序不需要许可。售卖或分发包含奥莱利书籍示例的 CD-ROM 需要许可。通过引用本书和引用示例代码来回答问题不需要许可。将本书大量示例代码整合到产品文档中需要许可。

我们感谢但不需要署名。署名通常包括标题、作者、出版商和 ISBN。例如：“*Programming TypeScript* by Boris Cherny (O’Reilly). Copyright 2019 Boris Cherny, 978-1-492-03765-1.”

如果您认为您对示例代码的使用超出了合理使用范围或上述许可，请随时通过*permissions@oreilly.com*联系我们。

# 奥莱利在线学习

###### 注意

近 40 年来，[*奥莱利传媒*](http://oreilly.com) 提供技术和商业培训、知识和见解，帮助公司取得成功。

我们独特的专家和创新者网络通过书籍、文章、会议以及我们的在线学习平台分享他们的知识和专业知识。奥莱利的在线学习平台为您提供按需访问的实时培训课程、深入学习路径、交互式编码环境以及奥莱利及其他 200 多家出版商的大量文本和视频。更多信息，请访问[*http://oreilly.com*](http://oreilly.com)。

# 如何联系我们

请将关于本书的评论和问题发送给出版商：

+   奥莱利传媒公司

+   1005 Gravenstein Highway North

+   Sebastopol, CA 95472

+   800-998-9938 (在美国或加拿大)

+   707-829-0515 (国际或当地)

+   707-829-0104 (传真)

我们为本书准备了一个网页，其中列出了勘误、示例和任何其他信息。您可以访问这个页面：[*https://oreil.ly/programming-typescript*](https://oreil.ly/programming-typescript)。

如果您对本书有评论或技术问题，请发送电子邮件至*bookquestions@oreilly.com*。

获取关于我们的书籍、课程、会议和新闻的更多信息，请访问我们的网站：[*http://www.oreilly.com*](http://www.oreilly.com)

在 Facebook 上找到我们：[*http://facebook.com/oreilly*](http://facebook.com/oreilly)

在 Twitter 上关注我们：[*http://twitter.com/oreillymedia*](http://twitter.com/oreillymedia)

在 YouTube 上观看我们：[*http://www.youtube.com/oreillymedia*](http://www.youtube.com/oreillymedia)

# 致谢

这本书是多年碎片和涂鸦的产物，紧随其后的是一年早晨、夜晚、周末和假期的时间，用于写作。

感谢 O’Rielly 为我提供参与本书编写的机会，感谢我的编辑 Angela Rufino 在整个过程中的支持。感谢 Nick Nance 在“Typesafe APIs”中的贡献，以及 Shyam Seshadri 在“Angular 6/7”中的贡献。感谢我的技术编辑们：TypeScript 团队的 Daniel Rosenwasser，在阅读这份手稿并指导我了解 TypeScript 类型系统的微妙之处时花费了大量的时间；Jonathan Creamer、Yakov Fain、Paul Buying 和 Rachel Head 为技术编辑和反馈所做的贡献。感谢我的家人——Liza 和 Ilya，Vadim，Roza 和 Alik，Faina 和 Yosif——鼓励我追求这个项目。

最重要的是，感谢我的搭档 Sara Gilford，在整个写作过程中支持我，即使这意味着取消周末计划、深夜写作和编码，以及关于类型系统的内外讨论太多。没有你的支持，我无法完成这个项目，我会永远感激你的支持。

^(1) 如果你不是来自 JavaScript，这里有个例子：如果你有一个对象`o`，并且想要向其添加属性`k`，并赋值为`3`，你可以直接修改`o`——`o.k = 3`——或者你可以对`o`应用你的更改，生成一个*新*对象作为结果——`let p = {...o, k: 3}`。
